<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explore Films</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="/css/explore.css" rel="stylesheet">
</head>

<body>
    <nav class="navigation">
        <div class="navigation-items">
            <a href="/homepage-authenticated" class="brand">Rent Film</a>

            <div class="nav-links">
                <a href="/homepage-authenticated">Home</a>
                <a href="/about">About us</a>
                <a href="/explore" class="active">Explore</a>
            </div>

            <div id="userSection" class="user-section">
                <div class="user-dropdown">
                    <span id="username" th:text="${username}" class="dropdown-trigger">Username</span>
                    <div id="dropdownContent" class="dropdown-content">
                        <a href="/profile">Profile</a>
                        <form th:action="@{/logout}" method="post" style="margin: 0;">
                            <a href="#" onclick="this.closest('form').submit(); return false;">Logout</a>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header section -->
    <header class="explore-header">
        <h1>EXPLORE FILMS</h1>
        <p>SEARCH YOUR FAVORITE MOVIES BY GENRE, ACTOR, OR TITLE WITH ONE CLICK.</p>
    </header>

    <!-- Search section -->
    <section class="search-section">
        <form th:action="@{/explore/search}" method="get">
            <div class="search-container">
                <input type="text" name="judul" th:value="${searchJudul}" class="search-input"
                    placeholder="Search by title...">
                <button type="submit" class="search-button">SEARCH</button>
            </div>

            <div class="filter-options">
                <select name="genreId" class="filter-select">
                    <option value="">All Genres</option>
                    <option th:each="genre : ${genres}" th:value="${genre.id}" th:text="${genre.nama}"
                        th:selected="${genre.id == searchGenreId}"></option>
                </select>

                <select name="tahunRilis" class="filter-select">
                    <option value="">Release Year</option>
                    <option th:each="year : ${#numbers.sequence(2024, 1990)}" th:value="${year}" th:text="${year}"
                        th:selected="${year == searchTahunRilis}"></option>
                </select>
            </div>
        </form>
    </section>

    <!-- Film grid -->
    <div class="film-grid">
        <div th:if="${films != null && !films.empty}" class="grid-container">
            <div th:each="film : ${films}" class="film-card">
                <div class="film-image">
                    <!-- Ubah path cover -->
                    <img th:src="@{'/covers/' + ${film.coverUrl}}" th:alt="${film.judul}" class="film-cover"
                        onerror="this.src='/images/default-cover.jpg'">
                </div>
                <div class="film-details">
                    <h3 class="film-title" th:text="${film.judul}">Film Title</h3>
                    <p class="film-year" th:text="${film.tahunRilis}">2024</p>
                    <a th:href="@{'/films/' + ${film.id}}" class="view-details">View Details</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Pagination -->
    <div class="pagination" th:if="${totalPages > 1}">
        <div class="pagination-controls">
            <a th:if="${currentPage > 0}"
                th:href="@{/explore(page=${currentPage - 1}, size=12, judul=${searchJudul}, genreId=${searchGenreId}, tahunRilis=${searchTahunRilis}, available=${searchAvailable})}"
                class="pagination-button">&laquo; Previous</a>
            <span class="pagination-info" th:text="${'Page ' + (currentPage + 1) + ' of ' + totalPages}"></span>
            <a th:if="${currentPage < totalPages - 1}"
                th:href="@{/explore(page=${currentPage + 1}, size=12, judul=${searchJudul}, genreId=${searchGenreId}, tahunRilis=${searchTahunRilis}, available=${searchAvailable})}"
                class="pagination-button">Next &raquo;</a>
        </div>
    </div>

    <!-- No results message -->
    <div th:if="${#lists.isEmpty(films)}" class="no-results">
        <h3>No films found matching your search criteria</h3>
        <p>Try adjusting your search filters or browse all films</p>
    </div>
    </div>

    <footer class="explore-footer">
        <p>&copy; 2024 RENTAL FILM. ALL RIGHTS RESERVED.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const dropdownTrigger = document.querySelector('.dropdown-trigger');
            const dropdownContent = document.getElementById('dropdownContent');

            // Toggle dropdown on click
            dropdownTrigger.addEventListener('click', function (e) {
                e.preventDefault();
                e.stopPropagation();
                dropdownContent.classList.toggle('show');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function (e) {
                if (!e.target.matches('.dropdown-trigger')) {
                    if (dropdownContent.classList.contains('show')) {
                        dropdownContent.classList.remove('show');
                    }
                }
            });
        });
    </script>

</body>

</html>